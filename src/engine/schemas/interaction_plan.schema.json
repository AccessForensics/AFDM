{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Appendix A2 — InteractionPlan Schema (Locked)",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "allegation_id","context_id","start_url","target_state_description",
    "permitted_actions","stop_condition","provenance",
    "plan_created_local","plan_created_epoch_ms"
  ],
  "properties": {
    "allegation_id": { "type": "string", "minLength": 1 },
    "context_id":    { "type": "string", "enum": ["desktop_baseline","mobile_baseline","authorized_reflow"] },
    "start_url":     { "type": "string", "format": "uri" },
    "target_state_description": { "type": "string", "minLength": 10 },
    "permitted_actions": {
      "type": "array", "minItems": 1, "uniqueItems": true,
      "items": { "type": "string", "enum": [
        "navigate","scroll","focus","open_menu","activate_control",
        "advance_step","submit_form","dismiss_modal","return_prior_state"
      ]}
    },
    "stop_condition": { "type": "string", "minLength": 5 },
    "provenance": {
      "type": "object", "additionalProperties": false, "required": ["type","ref"],
      "properties": {
        "type": { "type": "string", "enum": ["complaint_excerpt","scope_delta_id"] },
        "ref":  { "type": "string", "minLength": 1 }
      }
    },
    "plan_created_local":    { "type": "string", "minLength": 19 },
    "plan_created_epoch_ms": { "type": "integer", "minimum": 0 }
  }
}
